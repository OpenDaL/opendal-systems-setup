# Configuration for OpenDal Django APP

upstream django {
    server unix:///data/www/opendal_frontend.sock;
}

# configuration of the server
server {
    # the port your site will be served on
    listen      443 ssl;

    ssl_certificate    /data/certs/beta.opendatalibrary.com/certificate.pem;
    ssl_certificate_key    /data/certs/beta.opendatalibrary.com/private.key;

    server_name beta.opendatalibrary.com;
    charset     utf-8;

    # max upload size
    client_max_body_size 5M;   # adjust to taste

    # Add header to disable indexing
    add_header X-Robots-Tag none;

    # Host Static files with nginx
    location /static {
        alias /data/www/static;
    }

    # Set robots.txt on staging domain, to disable indexing
    location /robots.txt {
        alias /data/www/staging-robots.txt;
    }

    # All other requests should go to django
    location / {
        uwsgi_pass  django;
        include     /data/code/datacatalog-frontend/django/datacatalog/uwsgi_params;
    }
}
